---
title: "Python開発環境の備忘録"
emoji: "🐍"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["python", "black", "flask8", "mypy", "vscode"]
published: false
---


## 概要

Python開発環境、主にフォーマッター、リンター、型チェックについての備忘録です。
類似の記事も多数あり何番煎じかも分かりませんが、自分でまとめないと毎回ツールや設定方法を検索する羽目になりそうなので、未来の自分のためにメモを残します。


<!-- ---------------------------------------------------------------------- -->


## フォーマッター

フォーマッターを導入した理由は、コーディングスタイルで悩みたくないからです。
私は細かい部分を修正したくなる神経質な面があります。
その割に好みのスタイルが数カ月で変わり、過去書いたソースコードをその時の気分で直したくなり、スタイルを混在させてしまうことがあります。
他にも時間を置いて機能を追加する場合などは、元々のものを忘れ違うスタイルで書いてしまうことがあります。
また、チームで開発する際にコーディングスタイルを統一するのに役立ちます。
そういった理由からフォーマッターを導入しました。

導入したフォーマッターはblackとisortです。


<!-- ---------------------------------------------------------------------- -->


### [black](https://black.readthedocs.io/en/stable/index.html)

上記のような理由があって、カスタマイズできる項目が少なく制約の強いblackを導入しました。
正直気に入らないルールもありますが、主観的で気分的な理由がほとんどす。
また、チーム開発する際に好みのスタイルの押し付け合いになるのも不毛なので、blackのデフォルトに統一することにします。

下記コマンドでインストールできます。

```bash
pip install black
```

また、下記コマンドで指定のファイルおよびディレクトリ内のファイルをフォーマットします。

```bash
black {source_file_or_directory}
```

[公式ドキュメント](https://black.readthedocs.io/en/stable/usage_and_configuration/file_collection_and_discovery.html#gitignore)によると、--excludeオプションが設定されていない場合は.gitignoreで指定されているファイルはフォーマットしません。
また、.gitignoreで指定されているものに追加してフォーマットしたくないファイルがある場合は、--extend-excludeオプションで指定します。
フォーマット対象外設定も含めて、設定内容はコマンドラインで実行時にも指定できますが、pyproject.tomlに書くこともできます。

```toml:pyproject.toml
[tool.black]
# 公式ドキュメント
# https://black.readthedocs.io/en/stable/usage_and_configuration/the_basics.html#configuration-format

# ライン行数はデフォルトから変更する場合はコメントアウト
# line-length = 88

# デフォルトに追加したいフォーマット対象外指定ファイルやディレクトリ
extend-exclude = '''
(
      \.git
    | migrations/  # 自動生成されたDB migrationファイル
)
'''
```


<!-- ---------------------------------------------------------------------- -->


### [isort](https://pycqa.github.io/isort/)

isortはインポートをアルファベット順にソートするフォーマッターです。
ライブラリのソートはblackでは行わないため、isortを導入しました。

下記コマンドでインストールできます。

```bash
pip install isort
```

また、下記コマンドで指定のファイルおよびディレクトリ内のファイルをフォーマットします。

```bash
isort {source_file_or_directory}
```

設定はpyproject.tomlに記載します。
blackと共存して使う場合は設定ファイルpyproject.tomlにプロファイル設定を書きます。

```toml:pyproject.toml
[tool.isort]
# blackと共存して使う設定
# https://pycqa.github.io/isort/docs/configuration/black_compatibility.html
profile = "black"

# .gitignoreファイルで指定されているファイルを除外
skip_gitignore = true

# デフォルトに追加したいフォーマット対象外指定ファイルやディレクトリ
extend_skip_glob = ["**/migrations/*"]  # 自動生成されたDB migrationファイル
```


<!-- ---------------------------------------------------------------------- -->


## リンター


<!-- ---------------------------------------------------------------------- -->


## 型チェック


<!-- ---------------------------------------------------------------------- -->


## 外部ツール連携

### VSCode


<!-- ---------------------------------------------------------------------- -->


### Git
